<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.538">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Real Estate Investment Trust (REIT)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="REIT part 0315_files/libs/clipboard/clipboard.min.js"></script>
<script src="REIT part 0315_files/libs/quarto-html/quarto.js"></script>
<script src="REIT part 0315_files/libs/quarto-html/popper.min.js"></script>
<script src="REIT part 0315_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="REIT part 0315_files/libs/quarto-html/anchor.min.js"></script>
<link href="REIT part 0315_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="REIT part 0315_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="REIT part 0315_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="REIT part 0315_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="REIT part 0315_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The Real Estate Investment Trust (REIT)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-real-estate-investment-trust-reit" class="level1">
<h1>The Real Estate Investment Trust (REIT)</h1>
<section id="what-is-reits" class="level2">
<h2 class="anchored" data-anchor-id="what-is-reits">What is REITs</h2>
<p>A real estate investment trust (REIT) is a company that owns, operates, or finances income-generating real estate. They package properties they owned as mutual trusts and put into equity market.</p>
<p>The function of REITs is similar to stock. They pool the capital of numerous investors. This makes it possible for individual investors to earn dividends from real estate investments without having to buy, manage, or finance any properties themselves. Compared with physical real estate investments, REITs is more accessible and liquid.</p>
<p>Moreover, REITs invest in most real estate property types, including apartment buildings, data centers, hotels, medical facilities, offices, retail centers, and warehouses etc. In other words, REITs is flexible in invest in commercial, public and residential property at same period. In contrast, the physical real estate investments may not achieve this diversification.</p>
</section>
<section id="s-reits" class="level2">
<h2 class="anchored" data-anchor-id="s-reits">S-REITs</h2>
<p>Singapore REITs are an important component of Singapore’s stock market</p>
<p>Largest REIT market in Asia ex-Japan. Specially, one-fifth the stock market of SG is taken by REITs. Source: <a href="https://www.reitas.sg/singapore-reits/overview-of-the-s-reit-industry/" class="uri">https://www.reitas.sg/singapore-reits/overview-of-the-s-reit-industry/</a></p>
<div id="cell-1" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace with your actual data (lists, NumPy arrays, or Pandas DataFrames)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">74.4</span>, <span class="fl">4.3</span>, <span class="fl">83.4</span>, <span class="fl">105.8</span>, <span class="fl">59.4</span>, <span class="fl">1135.53</span>]  <span class="co"># Sample data (replace with your data)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>categories <span class="op">=</span> [<span class="st">"Singapore"</span>, <span class="st">"China"</span>, <span class="st">"Australia"</span>, <span class="st">"Japan"</span>, <span class="st">"UK"</span>, <span class="st">"United States"</span>]  <span class="co"># Category labels for the bars (optional)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the bar chart</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>p1<span class="op">=</span>plt.bar(categories, data, color<span class="op">=</span><span class="st">'tan'</span>)  <span class="co"># You can change the color</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title for the chart</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Countries"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"REIT market cap (US$BIL)"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Market cap comparisons"</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the data points on top of each bar</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> bar <span class="kw">in</span> bars:</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get bar height from the bar object</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    bar_height <span class="op">=</span> bar.get_height()</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    plt.text(bar.get_x() <span class="op">+</span> bar.get_width() <span class="op">/</span> <span class="dv">2</span>, bar_height <span class="op">+</span> <span class="dv">1</span>, <span class="bu">str</span>(bar_height), ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the chart</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="REIT%20part%200315_files/figure-html/cell-2-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The market cap of S-REITs is comparable to Australia and UK. In percentage of the entire stock market, S-REITs shows a large impacts.</p>
<div id="cell-3" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tabulate</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Singapore"</span>, <span class="fl">74.4</span>, <span class="st">"12%"</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Japan"</span>, <span class="fl">105.8</span>, <span class="st">"3.5%"</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Australia"</span>, <span class="fl">83.4</span>, <span class="st">"6%"</span>],</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"UK"</span>, <span class="fl">59.4</span>, <span class="st">"2.2%"</span>],</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [<span class="st">"Country"</span>, <span class="st">"REIT Market Cap(US$BIL)"</span>, <span class="st">"Percentage"</span>]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table (adjust format as needed)</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> tabulate.tabulate(data, headers<span class="op">=</span>headers, tablefmt<span class="op">=</span><span class="st">"grid"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-----------+---------------------------+--------------+
| Country   |   REIT Market Cap(US$BIL) | Percentage   |
+===========+===========================+==============+
| Singapore |                      74.4 | 12%          |
+-----------+---------------------------+--------------+
| Japan     |                     105.8 | 3.5%         |
+-----------+---------------------------+--------------+
| Australia |                      83.4 | 6%           |
+-----------+---------------------------+--------------+
| UK        |                      59.4 | 2.2%         |
+-----------+---------------------------+--------------+</code></pre>
</div>
</div>
</section>
<section id="characterizes-of-reits" class="level2">
<h2 class="anchored" data-anchor-id="characterizes-of-reits">characterizes of REITs</h2>
<section id="high-dividends-but-low-value" class="level3">
<h3 class="anchored" data-anchor-id="high-dividends-but-low-value">High dividends but low value</h3>
<p>By law and IRS regulation, REITs must pay out 90% or more of their taxable profits to shareholders in the form of dividends. As a result, REIT companies are often exempt from most corporate income tax. Hence, REITs provide a high dividend for investors.</p>
<p><em>Forward dividend &amp; yield</em> The percentage of a company’s current stock price that it expects to pay out as dividends over 12 months. (Based on 15th March close price calculation)</p>
<p>REITs:</p>
<p>Sabana REIT (SGX: M1GU) An industrial REIT with a portfolio of 18 properties in Singapore covering high-tech industrial, warehouse and logistics, and general industrial sectors.</p>
<p>Keppel Pacific Oak US REIT (SGX: CMOU) An office REIT with 13 freehold office buildings and business campuses across eight markets in the US.</p>
<p>Frasers Logistics &amp; Commercial Trust (SGX: BUOU) A diversified portfolio of 108 properties across Singapore, the UK, Australia, the netherlands and Germany.</p>
<p>Mapletree Logistics Trust (SGX: M44U) An industrial REIT with a portfolio of 187 properties spread across eight countries. The price of these REITs in over one years.</p>
<p>Stocks in other sectors (Non-REITs): SGX-Singapore Exchange Limited, Telecommunications - Singapore Telecommunications Limited, Industrial Goods and shipbuilding - Yangzijiang Shipbuilding (Holdings) Ltd. Food &amp; Beverage- Wilmar International Limited (5%) Agriculture Golden Agri-Resources Ltd Transportation-Singapore Airlines Limited Utilities-Sembcorp Industries Ltd Services-United Overseas Insurance Limited</p>
<p>Real-estate Stocks: Keppel Ltd. CapitaLand Investment Limited City Developments Limited</p>
<div id="cell-6" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Stock price and yield data (replace with your data)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>stock_price <span class="op">=</span> [<span class="fl">0.36</span>, <span class="fl">0.1260</span>, <span class="fl">1.02</span>, <span class="fl">1.44</span>, <span class="fl">9.43</span>, <span class="fl">2.48</span>, <span class="fl">0.27</span>, <span class="fl">1.7</span>, <span class="fl">3.39</span>, <span class="fl">7.28</span>, <span class="fl">2.67</span>, <span class="fl">6.38</span>, <span class="fl">5.05</span>, <span class="fl">5.91</span>,<span class="fl">6.02</span>,<span class="fl">2.66</span>,<span class="fl">1.07</span>,<span class="fl">1.92</span>,<span class="fl">2.18</span>,<span class="fl">1.28</span>,<span class="fl">2.27</span>,<span class="fl">0.56</span>,<span class="fl">1.68</span>,<span class="fl">6.78</span>,<span class="fl">1.16</span>,<span class="fl">9.72</span>,<span class="fl">3.15</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>yields <span class="op">=</span> [<span class="fl">0.03</span>, <span class="fl">0.05</span>, <span class="fl">0.07</span>, <span class="fl">0.09</span>, <span class="fl">0.34</span>, <span class="fl">0.11</span>, <span class="fl">0.02</span>, <span class="fl">0.05</span>, <span class="fl">0.17</span>, <span class="fl">0.34</span>, <span class="fl">0.12</span>, <span class="fl">0.38</span>, <span class="fl">0.16</span>, <span class="fl">0.16</span>,<span class="fl">0.17</span>,<span class="fl">0.09</span>,<span class="fl">0.07</span>,<span class="fl">0.11</span>,<span class="fl">0.09</span>,<span class="fl">0.09</span>,<span class="fl">0.1</span>,<span class="fl">0.04</span>,<span class="fl">0.09</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.4</span>,<span class="fl">0.04</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Company names (replace with your actual names)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> [<span class="st">"Sabana"</span>, <span class="st">"Keppel"</span>, <span class="st">"Frasers"</span>, <span class="st">"Mapletreet"</span>, <span class="st">"SGX"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"STL"</span>, <span class="st">"G-Agri"</span>, <span class="st">"YZJ."</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Wilmar"</span>, <span class="st">"Keppel Ltd. "</span>, <span class="st">"CapitaLand"</span>, <span class="st">"SIA"</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Sembcorp"</span>, <span class="st">"City Dev"</span>,<span class="st">"UOI"</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">""</span>,<span class="st">"iFAST"</span>,<span class="st">"StarHub"</span>,<span class="st">"Haw Par"</span>,<span class="st">"Bukit"</span>]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Group information (replace with your groupings)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>,<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>] </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>group_colors <span class="op">=</span> {<span class="st">'A'</span>: <span class="st">'blue'</span>, <span class="st">'B'</span>: <span class="st">'red'</span>, <span class="st">'C'</span>: <span class="st">'darkorange'</span>}</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [group_colors[group] <span class="cf">for</span> group <span class="kw">in</span> groups]</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))  <span class="co"># Adjust figure size (optional)</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with labels</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, (name, x, y) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(names, stock_price, yields)):</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  plt.scatter(x, y, color<span class="op">=</span>colors[i],  alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  plt.annotate(name, (x, y), textcoords<span class="op">=</span><span class="st">"offset points"</span>, xytext<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">4</span>), ha<span class="op">=</span><span class="st">"left"</span>, va<span class="op">=</span><span class="st">"center"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)  <span class="co"># Adjust label position</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 45-degree line for average yield (adjust y-axis limits if needed)</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">10</span>], [<span class="dv">0</span>, <span class="fl">0.5</span>], color<span class="op">=</span><span class="st">'black'</span>, linestyle<span class="op">=</span><span class="st">'dashed'</span>, label<span class="op">=</span><span class="st">'45 degree line(5%)'</span>) </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels and title</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Stock Price"</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Yield (%)"</span>)  <span class="co"># Clarify unit</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"REITs Yields vs. Other Yields"</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">False</span>)  <span class="co"># Add grid with customization</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()  <span class="co"># Adjust spacing for readability</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="REIT%20part%200315_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The forward dividends &amp; yields of REITs is relative high. However, the price of REITs less than other stocks.</p>
<p>Why ? The contractual nature of commercial real estate leases and the predictability of rental income and expenses give REITs a defensive quality - the price is relative stable at certain level.</p>
</section>
<section id="stability" class="level3">
<h3 class="anchored" data-anchor-id="stability">stability</h3>
<p>The character of REITs allowing analysts to more accurately forecast earnings, which helps reduce share price volatility.</p>
<div id="cell-8" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tabulate</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Sabana REIT (SGX: M1GU)"</span>, <span class="st">"0.3600 - 0.3650"</span>, <span class="fl">0.3600</span> <span class="op">-</span> <span class="fl">0.3650</span>, <span class="st">"0.3550 - 0.4900"</span>,<span class="fl">0.3550</span> <span class="op">-</span> <span class="fl">0.4900</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Keppel Pacific Oak US REIT (SGX: CMOU)"</span>, <span class="st">"0.1260 - 0.1350"</span>,<span class="fl">0.1260</span> <span class="op">-</span> <span class="fl">0.1350</span>,<span class="st">"0.1230 - 0.4450"</span>, <span class="fl">0.1230</span> <span class="op">-</span> <span class="fl">0.4450</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Frasers Logistics &amp; Commercial Trust (SGX: BUOU)"</span>, <span class="st">"1.0200 - 1.0400"</span>,<span class="fl">1.0200</span> <span class="op">-</span> <span class="fl">1.0400</span>,<span class="st">"1.0200 - 1.0400"</span>, <span class="fl">1.0000</span> <span class="op">-</span> <span class="fl">1.3600</span>],</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Mapletree Logistics Trust (SGX: M44U)"</span>, <span class="st">"1.4300 - 1.4600"</span>,<span class="fl">1.4300</span> <span class="op">-</span> <span class="fl">1.4600</span>, <span class="st">"1.4300 - 1.8000"</span>,<span class="fl">1.4300</span> <span class="op">-</span> <span class="fl">1.8000</span>],</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [<span class="st">"REITs"</span>, <span class="st">"Daily range"</span>,<span class="st">"spread"</span>, <span class="st">"52-week range"</span>,<span class="st">"spread"</span>]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table (adjust format as needed)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> tabulate.tabulate(data, headers<span class="op">=</span>headers, tablefmt<span class="op">=</span><span class="st">"grid"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+--------------------------------------------------+-----------------+----------+-----------------+----------+
| REITs                                            | Daily range     |   spread | 52-week range   |   spread |
+==================================================+=================+==========+=================+==========+
| Sabana REIT (SGX: M1GU)                          | 0.3600 - 0.3650 |   -0.005 | 0.3550 - 0.4900 |   -0.135 |
+--------------------------------------------------+-----------------+----------+-----------------+----------+
| Keppel Pacific Oak US REIT (SGX: CMOU)           | 0.1260 - 0.1350 |   -0.009 | 0.1230 - 0.4450 |   -0.322 |
+--------------------------------------------------+-----------------+----------+-----------------+----------+
| Frasers Logistics &amp; Commercial Trust (SGX: BUOU) | 1.0200 - 1.0400 |   -0.02  | 1.0200 - 1.0400 |   -0.36  |
+--------------------------------------------------+-----------------+----------+-----------------+----------+
| Mapletree Logistics Trust (SGX: M44U)            | 1.4300 - 1.4600 |   -0.03  | 1.4300 - 1.8000 |   -0.37  |
+--------------------------------------------------+-----------------+----------+-----------------+----------+</code></pre>
</div>
</div>
</section>
<section id="exposure-to-global-real-estate" class="level3">
<h3 class="anchored" data-anchor-id="exposure-to-global-real-estate">Exposure to global real estate</h3>
<p>Over 90% of S-REITS own properties outside Singapore. Digging deeper in the systematic risk these REITs face.</p>
<p>For analysis, in this section, we use CSOP iEdge S-REIT Leaders Index ETF (SRU.SI) as a proxy for SREITs and SG real estate market.</p>
<p>Top 7 Holdings of CSOP iEdge S-REIT Leaders Index ETF (55.04% of Total Assets)</p>
<div id="cell-10" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tabulate</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"CapitaLand Integrated Commercial Trust"</span>, <span class="st">"10.67%"</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Mapletree Logistics Trust"</span>, <span class="st">"9.17%"</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Mapletree Industrial Trust"</span>, <span class="st">"8.67%"</span>],</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Frasers Logistics &amp; Commercial Trust"</span>, <span class="st">"7.39%"</span>],</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Keppel REIT"</span>,<span class="st">"6.84%"</span>],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Keppel DC REIT"</span>,<span class="st">"6.34%"</span>],</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Frasers Centrepoint Trust"</span>,<span class="st">"5.98%"</span>]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [<span class="st">"REITs"</span>, <span class="st">"%Assets"</span>]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table (adjust format as needed)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> tabulate.tabulate(data, headers<span class="op">=</span>headers, tablefmt<span class="op">=</span><span class="st">"grid"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+----------------------------------------+-----------+
| REITs                                  | %Assets   |
+========================================+===========+
| CapitaLand Integrated Commercial Trust | 10.67%    |
+----------------------------------------+-----------+
| Mapletree Logistics Trust              | 9.17%     |
+----------------------------------------+-----------+
| Mapletree Industrial Trust             | 8.67%     |
+----------------------------------------+-----------+
| Frasers Logistics &amp; Commercial Trust   | 7.39%     |
+----------------------------------------+-----------+
| Keppel REIT                            | 6.84%     |
+----------------------------------------+-----------+
| Keppel DC REIT                         | 6.34%     |
+----------------------------------------+-----------+
| Frasers Centrepoint Trust              | 5.98%     |
+----------------------------------------+-----------+</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"2023-01-01"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2023-12-31"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> [<span class="st">"SRU.SI"</span>,<span class="st">"STI"</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(tickers, start<span class="op">=</span>start_date, end<span class="op">=</span>end_date)[<span class="st">"Adj Close"</span>]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ticker <span class="kw">in</span> data.columns:</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    data[<span class="ss">f"</span><span class="sc">{</span>ticker<span class="sc">}</span><span class="ss">_log_return"</span>] <span class="op">=</span> np.log(data[ticker] <span class="op">/</span> data[ticker].shift(<span class="dv">1</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[*********************100%%**********************]  3 of 3 completed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ticker             SPY  SRU.SI     STI  SPY_log_return  SRU.SI_log_return  \
Date                                                                        
2023-01-03  373.956818   0.626  10.220             NaN                NaN   
2023-01-04  376.843842   0.626  10.230        0.007691                0.0   
2023-01-05  372.542755   0.626  10.230       -0.011479                0.0   
2023-01-06  381.085968   0.626  10.230        0.022673                0.0   
2023-01-09  380.869934   0.626  10.235       -0.000567                0.0   

Ticker      STI_log_return  
Date                        
2023-01-03             NaN  
2023-01-04        0.000978  
2023-01-05        0.000000  
2023-01-06        0.000000  
2023-01-09        0.000489  </code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress SREITs on STI </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.api <span class="im">import</span> OLS</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"SRU.SI_log_return"</span>] <span class="op">=</span> np.log(data[<span class="st">"SRU.SI"</span>] <span class="op">/</span> data[<span class="st">"SRU.SI"</span>].shift(<span class="dv">1</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"STI_log_return"</span>] <span class="op">=</span> np.log(data[<span class="st">"STI"</span>] <span class="op">/</span> data[<span class="st">"STI"</span>].shift(<span class="dv">1</span>))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data.dropna()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Select data from the second row onwards (excluding the first row with NaN)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>sru <span class="op">=</span> data[<span class="st">"SRU.SI_log_return"</span>][<span class="dv">1</span>:]</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>sti <span class="op">=</span> data[<span class="st">"STI_log_return"</span>][<span class="dv">1</span>:]</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the independent variable DataFrame (including constant term)</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.DataFrame({<span class="st">'const'</span>: <span class="dv">1</span>, <span class="st">'STI_log_return'</span>: sti})</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the regression using OLS</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> OLS(sru, X).fit()</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:      SRU.SI_log_return   R-squared:                       0.003
Model:                            OLS   Adj. R-squared:                 -0.001
Method:                 Least Squares   F-statistic:                    0.7061
Date:                Sat, 16 Mar 2024   Prob (F-statistic):              0.402
Time:                        20:43:38   Log-Likelihood:                 668.64
No. Observations:                 227   AIC:                            -1333.
Df Residuals:                     225   BIC:                            -1326.
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==================================================================================
                     coef    std err          t      P&gt;|t|      [0.025      0.975]
----------------------------------------------------------------------------------
const              0.0001      0.001      0.148      0.883      -0.002       0.002
STI_log_return    -0.0219      0.026     -0.840      0.402      -0.073       0.029
==============================================================================
Omnibus:                       86.636   Durbin-Watson:                   1.876
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             1913.019
Skew:                           0.884   Prob(JB):                         0.00
Kurtosis:                      17.111   Cond. No.                         30.7
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<ol type="1">
<li><p>Regress the REIT Index on STI, identify the foreigner market contributor of the price of REITs. (Put the dividend back)</p></li>
<li><p>CAPM model: the <span class="math inline">\(\beta\)</span> of REITs for further analysis.</p></li>
</ol>
<p>REITs offer a strong, stable annual dividends, while the risk exposure to market has not magnified. How S-REITs relate to other market.</p>
<div id="cell-15" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf  <span class="co"># Assuming you have yfinance installed</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"2024-01-31"</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2024-03-15"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> [<span class="st">"SRU.SI"</span>, <span class="st">"CFA.SI"</span>, <span class="st">"N6M.SI"</span>, <span class="st">"^GSPC"</span>,<span class="st">"OXMU.SI"</span>, <span class="st">"REET"</span>]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(tickers, start<span class="op">=</span>start_date, end<span class="op">=</span>end_date)[<span class="st">"Adj Close"</span>]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>log_returns <span class="op">=</span> np.log(data <span class="op">/</span> data.shift(<span class="dv">1</span>))</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>log_returns <span class="op">=</span> log_returns.dropna()</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> log_returns.corr()</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(correlation_matrix)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Custom formatting with f-strings</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>table_string <span class="op">=</span> <span class="st">""</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> tickers:</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    table_string <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span>name<span class="sc">:10}</span><span class="ss">"</span>  <span class="co"># Adjust column width as needed</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>table_string <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>  <span class="co"># Newline for table border</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add separator row</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(tickers) <span class="op">+</span> <span class="dv">1</span>):  <span class="co"># Include extra separator for ticker names</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    table_string <span class="op">+=</span> <span class="st">"-"</span> <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Adjust separator width as needed</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>table_string <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Add data rows with ticker names</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix)):</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    ticker_name <span class="op">=</span> tickers[i]</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    table_string <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span>ticker_name<span class="sc">:10}</span><span class="ss">"</span>  <span class="co"># Add ticker name in first column</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(correlation_matrix.columns)):</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        value <span class="op">=</span> correlation_matrix.iloc[i, j]</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        table_string <span class="op">+=</span> <span class="ss">f"</span><span class="sc">{</span>value<span class="sc">:10.2f}</span><span class="ss">"</span>  <span class="co"># Format with decimal places</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    table_string <span class="op">+=</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table_string)</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[*********************100%%**********************]  6 of 6 completed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ticker     CFA.SI    N6M.SI   OXMU.SI      REET    SRU.SI     ^GSPC
Ticker                                                             
CFA.SI   1.000000  0.362659  0.084226  0.125613  0.587860  0.346147
N6M.SI   0.362659  1.000000 -0.287544  0.320140 -0.064596  0.020788
OXMU.SI  0.084226 -0.287544  1.000000 -0.432248  0.261643  0.010111
REET     0.125613  0.320140 -0.432248  1.000000 -0.048407  0.318785
SRU.SI   0.587860 -0.064596  0.261643 -0.048407  1.000000  0.249031
^GSPC    0.346147  0.020788  0.010111  0.318785  0.249031  1.000000
SRU.SI    CFA.SI    N6M.SI    ^GSPC     OXMU.SI   REET      
----------------------------------------------------------------------
SRU.SI          1.00      0.36      0.08      0.13      0.59      0.35
CFA.SI          0.36      1.00     -0.29      0.32     -0.06      0.02
N6M.SI          0.08     -0.29      1.00     -0.43      0.26      0.01
^GSPC           0.13      0.32     -0.43      1.00     -0.05      0.32
OXMU.SI         0.59     -0.06      0.26     -0.05      1.00      0.25
REET            0.35      0.02      0.01      0.32      0.25      1.00
</code></pre>
</div>
</div>
<p>(1)S REITs: CSOP iEdge S-REIT Leaders Index ETF (SRU.SI)<br>
(2)Asia ex Japan REITs: NikkoAM-StraitsTrading Asia ex Japan REIT ETF (CFA.SI)<br>
(3)US Bonds: iShares J.P. Morgan USD Asia Credit Bond Index ETF (N6M.SI)<br>
(4)US Equities (S&amp;P 500 Index):S&amp;P 500 (^GSPC)<br>
(5)US REITs: Prime US REIT (OXMU.SI)<br>
(6)Global REIT: iShares Global REIT ETF (REET)</p>
<p><a href="C:/Users/vic52/Documents/GitHub/sgx3000/REITs%20analysis/SGXcorr.pdf">SGX research</a></p>
</section>
<section id="returns" class="level3">
<h3 class="anchored" data-anchor-id="returns">Returns</h3>
<p>REITs are sensitive to interest-rate movements.(add dividends back)</p>
</section>
<section id="diversification" class="level3">
<h3 class="anchored" data-anchor-id="diversification">diversification</h3>
<p>REITs provide diversification benefits.</p>
<ol type="1">
<li>Generate following portfolios:</li>
</ol>
<ol type="1">
<li>55% Market index funds + 35% Bonds + 10% REITs</li>
<li>40% Market index funds + 40% Bonds + 20% REITs</li>
<li>33.3% Market index funds + 33.3% Bonds + 33.3% REITs</li>
<li>60% Market index funds + 40% Bonds</li>
<li>80% Market index funds + 20% Bonds</li>
</ol>
<p>Market index: S&amp;P 500 (^GSPC) Bonds: iShares 0-5 Year TIPS Bond ETF (STIP) REITs: CSOP iEdge S-REIT Leaders Index ETF (SRU.SI)</p>
<div id="cell-20" class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get data from yahoo finance</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">"2019-01-01"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">"2024-01-01"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>tickers <span class="op">=</span> [<span class="st">"^GSPC"</span>,<span class="st">"SRU.SI"</span>,<span class="st">"STIP"</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>prices <span class="op">=</span> yf.download(tickers, start<span class="op">=</span>start_date, end<span class="op">=</span>end_date)[<span class="st">"Adj Close"</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.head())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[*********************100%%**********************]  3 of 3 completed</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Ticker      SRU.SI       STIP        ^GSPC  SRU.SI_log_return  \
Date                                                            
2021-01-04     NaN  92.023315  3700.649902                NaN   
2021-01-05     NaN  92.084961  3726.860107                NaN   
2021-01-06     NaN  92.067345  3748.139893                NaN   
2021-01-07     NaN  92.234604  3803.790039                NaN   
2021-01-08     NaN  92.172974  3824.679932                NaN   

Ticker      STIP_log_return  ^GSPC_log_return  
Date                                           
2021-01-04              NaN               NaN  
2021-01-05         0.000670          0.007058  
2021-01-06        -0.000191          0.005694  
2021-01-07         0.001815          0.014738  
2021-01-08        -0.000668          0.005477  </code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define asset weights as dictionaries for each portfolio</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>portfolio_weights <span class="op">=</span> {</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Portfolio 1"</span>: {<span class="st">"^GSPC"</span>: <span class="fl">0.55</span>, <span class="st">"STIP"</span>: <span class="fl">0.10</span>, <span class="st">"SRU.SI"</span>: <span class="fl">0.35</span>},</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Portfolio 2"</span>: {<span class="st">"^GSPC"</span>: <span class="fl">0.40</span>, <span class="st">"STIP"</span>: <span class="fl">0.20</span>, <span class="st">"SRU.SI"</span>: <span class="fl">0.40</span>},</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Portfolio 3"</span>: {<span class="st">"^GSPC"</span>: <span class="fl">0.33</span>, <span class="st">"STIP"</span>: <span class="fl">0.33</span>, <span class="st">"SRU.SI"</span>: <span class="fl">0.34</span>},</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Portfolio 4"</span>: {<span class="st">"^GSPC"</span>: <span class="fl">0.60</span>, <span class="st">"STIP"</span>: <span class="fl">0.00</span>, <span class="st">"SRU.SI"</span>: <span class="fl">0.40</span>},</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Portfolio 5"</span>: {<span class="st">"^GSPC"</span>: <span class="fl">0.80</span>, <span class="st">"STIP"</span>: <span class="fl">0.00</span>, <span class="st">"SRU.SI"</span>: <span class="fl">0.20</span>},</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the portfolio weights for each portfolio</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, weights <span class="kw">in</span> portfolio_weights.items():</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    total_weight <span class="op">=</span> <span class="bu">sum</span>(weights.values())</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if weights add up to 1 (or close to 1 due to rounding)</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(total_weight <span class="op">-</span> <span class="dv">1</span>) <span class="op">&gt;</span> <span class="fl">1e-6</span>:</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"WARNING: Weights in '</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">' do not sum to 1. Total: </span><span class="sc">{</span>total_weight<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> asset, weight <span class="kw">in</span> weights.items():</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>asset<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>weight<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Portfolio 1:
^GSPC: 0.55
STIP: 0.10
SRU.SI: 0.35

Portfolio 2:
^GSPC: 0.40
STIP: 0.20
SRU.SI: 0.40

Portfolio 3:
^GSPC: 0.33
STIP: 0.33
SRU.SI: 0.34

Portfolio 4:
^GSPC: 0.60
STIP: 0.00
SRU.SI: 0.40

Portfolio 5:
^GSPC: 0.80
STIP: 0.00
SRU.SI: 0.20</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>risk_free_rate <span class="op">=</span> <span class="fl">0.025</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>daily_log_returns <span class="op">=</span> prices.pct_change().dropna()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>annualized_returns <span class="op">=</span> daily_log_returns.mean() <span class="op">*</span> <span class="dv">252</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\vic52\AppData\Local\Temp\ipykernel_24476\3059946309.py:2: FutureWarning: The default fill_method='pad' in DataFrame.pct_change is deprecated and will be removed in a future version. Either fill in any non-leading NA values prior to calling pct_change or specify 'fill_method=None' to not fill NA values.
  daily_log_returns = prices.pct_change().dropna()</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="246">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_portfolio_return(weights, daily_returns):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Calculates the daily return of a portfolio based on weights and asset returns.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Args:</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">      weights (dict): Dictionary of asset weights for the portfolio.</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">      daily_returns (pd.DataFrame): DataFrame containing daily log returns for each asset.</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">      pd.Series or None: Daily return series for the portfolio or None if errors occur.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">try</span>:</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Ensure weights and daily returns have compatible shapes</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="bu">len</span>(weights) <span class="op">!=</span> daily_returns.shape[<span class="dv">1</span>]:</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>          <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Number of weights does not match number of assets in returns"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate portfolio return (weighted average of daily log returns)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>      portfolio_return <span class="op">=</span> np.<span class="bu">sum</span>(daily_returns <span class="op">*</span> weights, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> portfolio_return</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">except</span> (<span class="pp">ValueError</span>, <span class="pp">KeyError</span>) <span class="im">as</span> e:</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Error calculating return: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-24" class="cell" data-execution_count="247">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate daily portfolio returns for each portfolio</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> {}</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, weights <span class="kw">in</span> portfolio_weights.items():</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  portfolio_returns[name] <span class="op">=</span> calculate_portfolio_return(weights, daily_log_returns)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, return_val <span class="kw">in</span> portfolio_returns.items():</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> return_val <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate portfolio standard deviation (annualized)</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        portfolio_std <span class="op">=</span> return_val.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ... rest of the code</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Skipping Sharpe Ratio calculation for </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> due to missing return data."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="248">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_sharpe_ratio(portfolio_return, risk_free_rate, portfolio_std):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Calculates the Sharpe Ratio for a portfolio.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">  Args:</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">      portfolio_return (float): Annualized return of the portfolio.</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">      risk_free_rate (float): Annualized risk-free rate.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">      portfolio_std (float): Annualized standard deviation of the portfolio return.</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns:</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">      float: Sharpe Ratio value.</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  excess_return <span class="op">=</span> portfolio_return <span class="op">-</span> risk_free_rate</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> excess_return <span class="op">/</span> portfolio_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-26" class="cell" data-execution_count="249">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Sharpe Ratio for each portfolio</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>sharpe_ratios <span class="op">=</span> {}</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, return_val <span class="kw">in</span> portfolio_returns.items():</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate portfolio standard deviation (annualized)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  portfolio_std <span class="op">=</span> return_val.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Sharpe Ratio</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  sharpe_ratio <span class="op">=</span> calculate_sharpe_ratio(return_val.mean(), risk_free_rate, portfolio_std)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  sharpe_ratios[name] <span class="op">=</span> sharpe_ratio</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sharpe Ratios for Each Portfolio:"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, sharpe_ratio <span class="kw">in</span> sharpe_ratios.items():</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>sharpe_ratio<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sharpe Ratios for Each Portfolio:
Portfolio 1: -0.18
Portfolio 2: -0.19
Portfolio 3: -0.22
Portfolio 4: -0.16
Portfolio 5: -0.15</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tabulate</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Portfolio 1"</span>, <span class="st">"55% Market index funds + 35% Bonds + 10% REITs"</span>,<span class="st">"-0.18"</span>,<span class="st">"3"</span>],</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Portfolio 2"</span>,<span class="st">"40% Market index funds + 40% Bonds + 20% REITs"</span>, <span class="st">"-0.19"</span>,<span class="st">"4"</span>],</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Portfolio 3"</span>,<span class="st">"33.3% Market index funds + 33.3% Bonds + 33.3% REITs"</span>, <span class="st">"-0.22"</span>,<span class="st">"5"</span>],</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Portfolio 4"</span>,<span class="st">"60% Market index funds + 40% Bonds"</span>, <span class="st">"-0.16"</span>,<span class="st">"2"</span>],</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"Portfolio 5"</span>,<span class="st">"80% Market index funds + 20% Bonds"</span>,<span class="st">"-0.15"</span>,<span class="st">"1"</span>],</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [<span class="st">"No."</span>, <span class="st">"Component"</span>,<span class="st">"Sharpe ration"</span>,<span class="st">"Sharpe Rank"</span>]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table (adjust format as needed)</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> tabulate.tabulate(data, headers<span class="op">=</span>headers, tablefmt<span class="op">=</span><span class="st">"grid"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+-------------+------------------------------------------------------+-----------------+---------------+
| No.         | Component                                            |   Sharpe ration |   Sharpe Rank |
+=============+======================================================+=================+===============+
| Portfolio 1 | 55% Market index funds + 35% Bonds + 10% REITs       |           -0.18 |             3 |
+-------------+------------------------------------------------------+-----------------+---------------+
| Portfolio 2 | 40% Market index funds + 40% Bonds + 20% REITs       |           -0.19 |             4 |
+-------------+------------------------------------------------------+-----------------+---------------+
| Portfolio 3 | 33.3% Market index funds + 33.3% Bonds + 33.3% REITs |           -0.22 |             5 |
+-------------+------------------------------------------------------+-----------------+---------------+
| Portfolio 4 | 60% Market index funds + 40% Bonds                   |           -0.16 |             2 |
+-------------+------------------------------------------------------+-----------------+---------------+
| Portfolio 5 | 80% Market index funds + 20% Bonds                   |           -0.15 |             1 |
+-------------+------------------------------------------------------+-----------------+---------------+</code></pre>
</div>
</div>
<p>The return three components: iShares 0-5 Year TIPS Bond ETF:<a href="https://www.ishares.com/us/products/239450/ishares-05-year-tips-bond-etf" class="uri">https://www.ishares.com/us/products/239450/ishares-05-year-tips-bond-etf</a> 3.45% 5years return<br>
S&amp;P 500: <a href="https://www.gurufocus.com/idx/%5EGSPC" class="uri">https://www.gurufocus.com/idx/%5EGSPC</a> 12% 5years return<br>
CSOP iEdge S-REIT Leaders Index ETF (SRU.SI):<a href="https://www.csopasset.com/sg/en/products/sg-reit/etf.php" class="uri">https://www.csopasset.com/sg/en/products/sg-reit/etf.php</a> -15% 5years return<br>
</p>
<div id="cell-29" class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>portfolio_returns <span class="op">=</span> {}</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, weights <span class="kw">in</span> portfolio_weights.items():</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  portfolio_return <span class="op">=</span> calculate_portfolio_return(weights, daily_log_returns)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> portfolio_return <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      portfolio_returns[name] <span class="op">=</span> {</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Annualized Return"</span>: portfolio_return.mean() <span class="op">*</span> <span class="dv">252</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Std Dev"</span>: portfolio_return.std() <span class="op">*</span> np.sqrt(<span class="dv">252</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>      <span class="bu">print</span>(<span class="ss">f"Skipping Sharpe Ratio calculation for </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> due to missing return data."</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract data for plotting</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>portfolio_names <span class="op">=</span> <span class="bu">list</span>(portfolio_returns.keys())</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>annual_returns <span class="op">=</span> [stats[<span class="st">"Annualized Return"</span>] <span class="cf">for</span> name, stats <span class="kw">in</span> portfolio_returns.items()]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>std_devs <span class="op">=</span> [stats[<span class="st">"Std Dev"</span>] <span class="cf">for</span> name, stats <span class="kw">in</span> portfolio_returns.items()]</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create scatter plot</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>plt.scatter(std_devs,annual_returns,marker<span class="op">=</span><span class="st">'o'</span>, c<span class="op">=</span><span class="st">'b'</span>, edgecolors<span class="op">=</span><span class="st">'k'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">'Portfolios'</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Standard Deviation'</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Annualized Return (%)'</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Portfolio Annualized Return vs. Standard Deviation'</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add portfolio names as annotations</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, name <span class="kw">in</span> <span class="bu">enumerate</span>(portfolio_names):</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  plt.annotate(name, ( std_devs[i],annual_returns[i]), textcoords<span class="op">=</span><span class="st">"offset points"</span>, xytext<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">10</span>), ha<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="REIT%20part%200315_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><em>Approach</em>: 1. Using the average annual total returns in FTSE ST REIT Index to generate the yield curve from 1 year to 25 years.</p>
<ol start="2" type="1">
<li><p>In contrast, plot the yield curve in stock index, bonds of SG market, combined with U.S. REITs and U.S. Market index.</p></li>
<li><p>Compare the long term return of each financial assets, to analysis the connection of REITs and other equity and identify the long-term advantage of REITs.</p></li>
</ol>
<section id="mitigate-economic-cycle-risk" class="level5">
<h5 class="anchored" data-anchor-id="mitigate-economic-cycle-risk">(2.4) Mitigate economic cycle risk</h5>
<p>Combining assets that exhibit low performance correlation can play an important role in reducing portfolio risk without sacrificing return potential. REITs is a good portfolio diversifier.</p>
<p><em>Approach</em>: 1. Generate following portfolios: (1) 55% Market index funds + 35% Bonds + 10% REITs (2) 40% Market index funds + 40% Bonds + 20% REITs (3) 33.3% Market index funds + 33.3% Bonds + 33.3% REITs (4) 60% Market index funds + 40% Bonds (5) 80% Market index funds + 20% Bonds</p>
<ol start="2" type="1">
<li><p>Calculate the expected returns, standard deviation of returns and Sharpe ratio on these portfolios.</p></li>
<li><p>Rank these portfolio under Sharpe ration, and plot the scatter diagram in average return and standard deviation.</p></li>
<li><p>Compare the average annualized return between the portfolios with REITs and without REITs. Analysis the ability of REITs in diversification of risk.</p></li>
</ol>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>